const omikujiConfig = {
    "ゾウ": {
        name: 'ゾウ',
        animalImg: './images/animals/zou.png',
        aboutTemplate: [
            '君は動物園のスター！恥ずかしがり屋でも色んな友達に会ってみよう',
            '毎日人を背中に乗せてる君、たまには家でゆっくりするんだゾウ',
            '誰もが羨ましがる鼻の長さ、ぱおーーん！',
            '大きな耳を持ったゾウを引いた君は、聞き上手',
        ],
        luckyAnimal: ['キリン', 'サル', '白鳥', 'カメ'],
        luckyAction: ['タイに行く', 'お散歩', '温泉に行く', '家でゴロゴロ'],
        luckyFood: ['リンゴ', 'ナシ', 'モモ', 'さくらんぼ'],
    },
    "ブタ": {
        name: 'ブタ',
        animalImg: './images/animals/buta.png',
        aboutTemplate: [
            '良くも悪くも普通の日！今日は頑張りすぎず、のんびりと過ごしましょう。',
            '友達と遊ぶと吉なようです！友達がいなくても、今日偶然出会った人を誘って楽しみましょう。',
            '好きなものに夢中になってみたい一日。あなたのペースを乱すものは、どんなものでも今日は距離を置きましょう。',
            '甘いものを食べると、リラックスして異性と接することができそう。好きな人とスイーツを分け合っては？',
        ],
        luckyAnimal: ['犬。。じゃなくて猫', 'カラス', 'バッタ', 'ネズミ'],
        luckyAction: ['猿回し', '帽子を被る', '食事', '日向ぼっこ'],
        luckyFood: ['バナナ', 'カレーライス', 'ササ', 'うまい棒'],
    },
    "ネコ": {
        name: 'ネコ',
        animalImg: './images/animals/neko.png',
        aboutTemplate: [
            '最近のんびりしがちなあなたは少し早めの行動が大切な一日。遅刻は許されませんよ。',
            '今日のあなたは超ラッキーな一日。どんなことがあっても神の使いがあなたを守ってくれることでしょう。',
            '自分のメンテナンスに使うお金は、新たな金運を呼び込む様子。思い切って休養を。',
            '小さな幸せで心がいっぱいに満たされそう。好きな趣味や読書などに夢中になると、昼間のことをすっかり忘れて幸せな気持ちで眠れますよ。',
        ],
        luckyAnimal: ['犬', '狼', 'ちょうちょ', 'コバエ'],
        luckyAction: ['お手', '泥浴び', '川下り', '月に向かって吠える'],
        luckyFood: ['ビーフジャーキー', '干草', 'リンゴ', '牛丼'],
    },
    "ヒツジ": {
        name: 'ヒツジ',
        animalImg: './images/animals/hituji.png',
        aboutTemplate: [
            '今日のあなたは超アンラッキーな一日。残念ながら頭が動物になってしまいます',
            '今日のあなたには休憩が必要なようです。一日美味しいものを食べて、ゆっくりしましょう！',
            '人から勧められた本や映画の中に、心をくすぐられるような特別なものがあるでしょう。早速おススメを聞いてみましょう！',
            '誰かのまねをしたり、気取ったりせず、自分らしさを大切にして、周囲の異性と接してください。今日は気になるあの人とうまく話せるはずです。',
        ],
        luckyAnimal: ['トンビ', 'ハト', 'たぬき', 'きつね'],
        luckyAction: [, '昼寝', '弱肉強食', '毛づくろい', 'ボスに従う'],
        luckyFood: [, '寿司', 'ラーメン', 'のり弁', 'アイスクリーム'],
    },
    "イヌ": {
        name: 'イヌ',
        animalImg: './images/animals/inu.png',
        aboutTemplate: [
            '今日のあなたはブラック系の洋服を身につけることで運気が上昇します。早速お出かけしましょう',
            '偶然乗り合わせたエレベーターや乗り物などで、意外な異性との出逢いがありそうな一日です。羨ましい。',
            '支出を費目別に分けて並べてみると、気づくことがあるでしょう。使いすぎの項目は見直して。',
            '普段通りの仕事内容になってしまいがち。でも、大きく成功したいなら、ほんの少しの冒険心を持つことがカギ。',
        ],
        luckyAnimal: ['サル', 'カエル', 'ブタ', 'チンパンジー'],
        luckyAction: ['座禅', '親孝行', '子供と遊ぶ', '爪切り'],
        luckyFood: ['カップ麺', 'ラムネ', 'フォー', 'クッキー'],
    },
    "カバ": {
        name: 'カバ',
        animalImg: './images/animals/kaba.png',
        aboutTemplate: [
            '新たな恋愛を育む未来が見えます。恋人がいない方は、特に今日という日を重要視して行動するようにしてください。',
            'あなたの職場でちょっとしたトラブルが持ち上がるかもしれません。そんな時は動物のように我関せず態度で逃げましょう',
            '感性が豊かになる日。五感がさえ、本当に良いものとの出会いがありそうです。',
            'これまでずっと探していたものに近い、あなたの感性にフィットするようなアイテムや情報が見つかるでしょう。',
        ],
        luckyAnimal: ['すずめ', 'ミミズ', 'メダカ', 'マンボウ'],
        luckyAction: ['横入り', '偽善', '積極的な発言', 'お茶くみ'],
        luckyFood: ['紅茶', '和菓子', 'インドカレー', '団子'],
    },
    "コアラ": {
        name: 'コアラ',
        animalImg: './images/animals/koara.png',
        aboutTemplate: [
            '恋愛運が向上している予感...。ですが、どんだけ頑張っても今日のところは単なる出逢いだけで留まります',
            '財運が好調な一日。宝くじを買いに行くことをお勧めします。当たったらご連絡くださいね。',
            '100円ショップに行ってみると、必要なものが手に入る予感。便利グッズにも出会えそう。',
            '人があなたの言うことをよく聞いてくれて、スムーズに動ける日。片腕となりそうな人材を見つける可能性もあります。',
        ],
        luckyAnimal: ['カメムシ', 'ワニ', 'カニ', 'サソリ'],
        luckyAction: ['ずる休み', 'トイレにこもる', '足を洗う', '目薬を差す'],
        luckyFood: ['グミ', '炭酸水', 'ホットケーキ', 'たこ焼き'],
    },
    "クマ": {
        name: 'クマ',
        animalImg: './images/animals/kuma.png',
        aboutTemplate: [
            '仕事でもプライベートでも毎日のようにこなさなくてはいけないことが、なんとなく面倒だと感じる日。今日は一日休みましょう。',
            '異性に対して不信感をだいてしまいそう。優しい言葉をかけてもらっても、裏を考えてしまって素直に喜べないようです。',
            '話がうますぎる儲け話には最大限の注意を。そもそも話を聞かないほうがいいようです。',
            '駆け引きがうまくいって、望む結果を手に入れられそう。不満に思うことが一部残っても、結果のほうを大事にしましょう。',
        ],
        luckyAnimal: ['ヒツジ', 'パンダ', 'トカゲ', 'ウナギ'],
        luckyAction: ['手を上げる', '靴下をはかない', '歯磨き', '耳かき'],
        luckyFood: ['うどん', 'そば', '天丼', 'たくあん'],
    },
    "パンダ": {
        name: 'パンダ',
        animalImg: './images/animals/panda.png',
        aboutTemplate: [
            '直感を大事にしたい日。人や物に対するこれまでの固定観念を一度手放して、自分がどう感じるかに注目しましょう。',
            '生きる喜びに満ちた一日になりそうです。ご飯がおいしいと感じたり、音楽を聴いて感動したり、そんな生活の中にちりばめられた小さな幸せを再確認する日になるでしょう。',
            'アプローチ法をこれまでとちょっと変えてみると効果的な日です。特に気になる異性がいる場所では、しぐさや身のこなし、声の出し方もひと工夫してみると、優しい反応をもらえそう。',
            'ポイントサービスやスタンプサービスにツキがありそう。情報を調べてみてください。',
        ],
        luckyAnimal: ['アロワナ', 'シロクマ', 'ゾウ', 'クマ'],
        luckyAction: ['死んだふり', '無視', '筋トレ', 'あいさつ'],
        luckyFood: ['チョコ', 'せんべい', 'パン', 'ナン'],
    },
    "ペンギン": {
        name: 'ペンギン',
        animalImg: './images/animals/pengin.png',
        aboutTemplate: [
            '感受性がとても優れている日。自分が感じたことを優先して、物事を判断してください。もしピンとこないなら、やめておくのが正解です。',
            '恋愛運はかなり波乱含みです。好きな人に対して、今まで我慢していたことやヤキモチで爆発しそうになるかもしれません。',
            '昔の人の知恵や言葉から、今後、お金に関しての座右の銘となりそうなものを手に入れられそうです。',
            '仕事仲間や部下が思うように動いてくれなくても、イライラしないように。まずは自分の目の前にある仕事に集中して。',
        ],
        luckyAnimal: ['にわとり', 'ブタ', 'うし', 'ひよこ'],
        luckyAction: ['がまん', '非常識な行動', '感謝', '人の話を聞く'],
        luckyFood: ['からし', 'わさび', '甘酒', '焼き芋'],
    },
    "ライオン": {
        name: 'ライオン',
        animalImg: './images/animals/raion.png',
        aboutTemplate: [
            '友人とのおしゃべりなどよりも、部屋を整えることを優先したい日です。汚れている場所を探してみましょう。',
            '人気運が上昇して、行く先々で声がかかりそうです。異性からの誘いもあるでしょう。',
            '財布やバッグの中を整理すると吉。不要なポイントカードや会員証、レシート類を処分してスッキリとさせると金運アップ。',
            '軽やかに仕事を終えることができそう。いつもならひるんでしまうような仕事でも、今日なら、なんなくこなせそう。',
        ],
        luckyAnimal: ['ネコ', 'イヌ', 'おじさん', '妖精'],
        luckyAction: ['祈る', '小走り', '人のいうことを聞く', 'へりくだる'],
        luckyFood: ['トマト', 'アイスキャンディー', 'コカ・コーラ', 'するめ'],
    },
    "リス": {
        name: 'リス',
        animalImg: './images/animals/risu.png',
        aboutTemplate: [
            '良い物を人と分かち合える一日。周囲にもっと仲良くなりたいと感じる人がいたら、あなたのお気に入りのアイテムをプレゼントしてみると効果的です。',
            '思っていたことが異性に伝わるでしょう。まさに以心伝心。意中の相手から電話やメールがくるかもしれません。',
            '大きな買い物をするかしないか、なかなか決められずイライラしてしまいそう。今日は見送ったほうが吉。',
            '今日はこまごまとした仕事を数多くこなすのに向いている日。時間がかかる仕事は、明日以降に回したほうがよさそう。',
        ],
        luckyAnimal: ['ヒツジ', 'とんび', 'ブラックバス', 'タコ'],
        luckyAction: ['勉強', '水やり', '皿洗い', '掃除'],
        luckyFood: ['煮干し', '豚骨ラーメン', '煮卵', 'ファンタグレープ'],
    },

    //トラ、ウマ、ウサギ、サルは未追加
};


class Omikuji {
    constructor() {
        this.omikujiInfo = omikujiConfig;
        this.yourAnimal = this.getAnimal()
    }

    getKeyFromDict(omikujiInfo) {
        // おみくじdictionaryからKeyを抽出し、動物を決めていきます
        // 引数：omikujiInfo
        // return: ブタとかヒツジとか
        let keys = Object.keys(omikujiInfo);
        return keys[keys.length * Math.random() << 0];
    };

    getElementFromList(animalPropertyList) {
        // 例：
        // aboutTemplate: ['ヒツジテンプレート1','ヒツジテンプレート2','ヒツジテンプレート3','ヒツジテンプレート4',]
        // からテンプレートを一つランダムに持ってくる
        return animalPropertyList[animalPropertyList.length * Math.random() << 0]
    }

    getAnimal() {
        // おみくじに使う動物・関連する情報を取得
        // 返り値：動物Keyに該当するValue → 検証したところObjectが返ってきました。
        return this.omikujiInfo[this.getKeyFromDict(this.omikujiInfo)];
    }

    getDisplayInfo() {
        // 返り値例：
        // {
        //     animalImg: '/images/animals/zou.png',
        //     aboutTemplate: 'ゾウテンプレート3',
        //     luckyAnimal: 'luckyAnimalぞう3',
        //     luckyAction: 'luckyActionぞう1',
        //     luckyFood: 'luckyFoodぞう3'
        //   }
        let animalDict = new Object();
        for (let [key, value] of Object.entries(this.yourAnimal)) {
            if (Array.isArray(value)) {
                value = this.getElementFromList(value)
            }
            animalDict[key] = value
        }
        return animalDict
    }
}

function getOmikujiHtml(obj) {
    return `
        <div class="scrollview p-2">
            <div class="container red-double-border-box my-3 py-3">
                <div class="d-flex ustify-content-center align-items-center flex-column">
                    <p class="h5 text-danger">動物占いみくじ</p>
                    <hr class="border-red my-3">
                    <img src="${obj.getDisplayInfo().animalImg}" width="270px">
                    <h1 class="text-danger text-big">${obj.getDisplayInfo().name}</h1>
                    <hr class="border-red my-3">
                    <p class="text-danger m-2">${obj.getDisplayInfo().aboutTemplate}</p>
                    <hr class="border-red my-3">
                    <p class="text-danger text-sakura m-2">ラッキー動物</p>
                    <h5 class="text-danger">${obj.getDisplayInfo().luckyAction}</h5>
                    <hr class="border-red my-3">
                    <p class="text-danger text-sakura m-2">ラッキーアクション</p>
                    <h5 class="text-danger">${obj.getDisplayInfo().luckyAction}</h5>
                    <hr class="border-red my-3">
                    <p class="text-danger text-sakura m-2">ラッキーフード</p>
                    <h5 class="text-danger">${obj.getDisplayInfo().luckyFood}</h5>
                    <hr class="border-red my-3">
                    <button class="btn btn-danger rounded-pill my-3" onclick="showTop()">もう一度おみくじを引く</button>
                </div>
            </div>
        </div>
        `;
}

// TOPページを表示する時の関数
function showTop() {
    let top = document.getElementById("top-page");
    const topHTML = `
            <div>
            <div class="text-center">
                <h1 class="text-danger font-syuji">ソフトウェア開発</h1>
                <h1 class="text-danger font-syuji">みくじ</h1>
                <img class="light m-4 omikuji-img" src="./images/omikuji.png" />
            </div>
            <div class="d-flex justify-content-around align-items-center pt-3 pb-5">
                <button type="button" class="btn btn-danger rounded-pill font-syuji" onclick="showOmikuji()">
                    おみくじを引く
                </button>
            </div>
        </div>
        <div class="d-flex flex-column">
            <div class="d-flex justify-content-center align-items-center">
                <a href="about.html">
                    <p class="text-danger font-syuji middle-font">このおみくじについて</p>
                </a>
                <p class="text-danger middle-font">｜</p>
                <a href="developers.html">
                    <p class="text-danger font-syuji text-decoration-none middle-font">開発者一覧</p>
                </a>
            </div>
            <div class="text-center">
                <p class="footer-font font-syuji text-danger">
                    ©ソフトウェア開発みくじ
                </p>
            </div>
        </div>
    `;

    top.innerHTML = topHTML;
    top.classList.add(
        "vh-100",
        "d-flex",
        "justify-content-center",
        "align-items-center",
        "flex-column"
    );

    let omikuji = document.getElementById("omikuji-page");
    omikuji.classList.remove(
        "vh-100",
        "d-flex",
        "justify-content-center",
        "align-items-center",
        "flex-column"
    );
    omikuji.classList.add("d-none");
    omikuji.innerHTML = "";

    return top;
}

// おみくじを表示する時の関数
function showOmikuji() {
    let omikujiEle = document.getElementById("omikuji-page");

    omikujiEle.classList.add(
        "vh-100",
        "d-flex",
        "justify-content-center",
        "align-items-center",
        "flex-column",
        "d-block"
    );

    // 呼び出し方を検討
    let omikuji = new Omikuji();
    omikujiEle.innerHTML = getOmikujiHtml(omikuji);

    // TOPページはおみくじページの表示の際には不要
    let top = document.getElementById("top-page");
    top.classList.remove(
        "vh-100",
        "d-flex",
        "justify-content-center",
        "align-items-center",
        "flex-column"
    )
    top.innerHTML = "";

    return omikujiEle;
}

// 初期はTOPページを表示
showTop();
